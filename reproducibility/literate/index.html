<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Literate programming - SC1</title>
    <meta property="og:title" content="Literate programming - SC1">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="Instead of imagining that our main task is to instruct a computer what to do, let us concentrate rather on explaining to human beings what we want a computer to do.
– Donald E. Knuth
[&amp;hellip;] &amp;hellip;">
      <meta property="og:description" content="Instead of imagining that our main task is to instruct a computer what to do, let us concentrate rather on explaining to human beings what we want a computer to do.
– Donald E. Knuth
[&amp;hellip;] &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/sc1/css/style.css" />
    <link rel="stylesheet" href="/sc1/css/fonts.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arvo">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Marcellus">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">

<link rel="stylesheet" href="/sc1/css/custom.css" />

<link rel="icon" href="/sc1/favicon.ico" type="image/x-icon" />























<nav class="breadcrumbs">
    
        <a href="https://awllee.github.io/sc1/">home / </a>
    
        <a href="https://awllee.github.io/sc1/reproducibility/">reproducibility / </a>
    
        <a href="https://awllee.github.io/sc1/reproducibility/literate/">literate / </a>
    
</nav>

  </head>

  
  <body class="sc1">
    <header class="masthead">
      <h1><a href="/sc1/">SC1</a></h1>

<p class="tagline">Statistical Computing 1</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/sc1/">Home</a></li>
  
  <li><a href="/sc1/intro-r/">Intro to R</a></li>
  
  <li><a href="/sc1/reproducibility/">Reproducibility</a></li>
  
  <li><a href="/sc1/common-r/">Common R</a></li>
  
  <li><a href="/sc1/tidyverse/">Tidyverse</a></li>
  
  <li><a href="/sc1/packages/">Packages</a></li>
  
  <li><a href="/sc1/functional-oo/">Functional / OO</a></li>
  
  <li><a href="/sc1/profile-debug/">Performance / Bugs</a></li>
  
  <li><a href="/sc1/matrices/">Matrices</a></li>
  
  <li><a href="/sc1/optimization/">Optimization</a></li>
  
  <li><a href="/sc1/integration/">Integration</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Literate programming</h1>

<h3>
</h3>
<hr>


      </header>




<link href="/sc1/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/sc1/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<blockquote>
<p>Instead of imagining that our main task is to instruct a <em>computer</em> what to do, let us concentrate rather on explaining to <em>human beings</em> what we want a computer to do.</p>
<p>– Donald E. Knuth</p>
</blockquote>
<p>Literate programming was introduced by Donald Knuth in <a href="https://doi.org/10.1093/comjnl/27.2.97">a 1984 article</a> featuring the quote above.</p>
<p>In practice, literate programming involves writing source code that can be processed to produce</p>
<ol style="list-style-type: decimal">
<li>a document explaining what the program does,</li>
<li>a program that can be executed.</li>
</ol>
<p>In this course, we focus on literate programming in R using <strong>RMarkdown</strong> ( <a href="https://rmarkdown.rstudio.com/">website</a>, <a href="https://bookdown.org/yihui/rmarkdown/">book</a>, <a href="https://github.com/rstudio/rmarkdown">code</a> ). In this specific approach to literate programming, one <em>knits</em> an RMarkdown file into an HTML or PDF file, and code <em>chunks</em> can be executed and displayed in the output.</p>
<div id="advantages" class="section level2">
<h2>Advantages</h2>
<ul>
<li>Code and documentation are consistent with each other, since they are produced from the same source.</li>
<li>One can focus on readability of the output document.</li>
<li>One can emphasize thought processes behind the code more clearly.</li>
</ul>
</div>
<div id="how-to-use-rmarkdown" class="section level2">
<h2>How to use RMarkdown</h2>
<p>If you already are familiar with a flavor of <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a>, RMarkdown primarily extends this with the ability to write and call R code.</p>
<p><a href="https://www.markdownguide.org/cheat-sheet/">This Markdown cheat sheet</a> is pretty self-explanatory. One can include R code chunks by inserting lines such as the following in an RMarkdown file.</p>
<pre><code>```{r[, &lt;any chunk options&gt;]}
# R code
```</code></pre>
<p>For example, writing</p>
<pre><code>```{r}
1 + 2
```</code></pre>
<p>gives rise to</p>
<pre class="r"><code>1 + 2</code></pre>
<pre><code>## [1] 3</code></pre>
<p>in the rendered document. Many of the webpages for this website are written using R Markdown, so you can view their source to see further examples. In RStudio, documents are rendered by clicking the “Knit” button.</p>
<p>The first few <a href="https://rmarkdown.rstudio.com/lesson-1.html">lessons</a> provided by RStudio may be helpful. There is an <a href="https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf">RMarkdown cheat sheet</a> as well.</p>
</div>
<div id="application-to-data-science" class="section level2">
<h2>Application to data science</h2>
<p>In many data science workflows, one uses a variety of functions to load and clean data, analyze it, and then display outputs and visualizations. A literate programming approach to these high-level tasks makes them more transparent and reproducible. Furthermore, the document can be designed with the intended audience in mind.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>This example concerns historical exchange rate data against the Euro, <a href="https://www.ecb.europa.eu/stats/policy_and_exchange_rates/euro_reference_exchange_rates/html/index.en.html">obtained from the European Central Bank</a>.</p>
<p>This page is written in RMarkdown: you can view the source by clicking the “View source” link at the bottom of the page.</p>
<pre class="r"><code>eurofxref &lt;- read.csv(&quot;../../static/data/eurofxref-hist.csv&quot;, na.strings=&quot;N/A&quot;)
eurofxref$Date &lt;- as.Date(eurofxref$Date)
n &lt;- length(eurofxref$Date)</code></pre>
<p>We can plot the USD and GBP rates over time.</p>
<pre class="r"><code>ylim &lt;- range(c(eurofxref$USD, eurofxref$GBP))
plot(eurofxref$Date, eurofxref$USD, pch=20, ylim=ylim,
  main=&quot;Daily exchange rate for USD (black) and GBP (red) against the Euro&quot;,
  xlab=&quot;Date&quot;, ylab=&quot;Price of 1 Euro&quot;)
points(eurofxref$Date, eurofxref$GBP, pch=20, col=&quot;red&quot;)</code></pre>
<p><img src="/sc1/reproducibility/literate_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We consider the daily change in exchange rates for both currencies.</p>
<pre class="r"><code>diff.USD &lt;- diff(eurofxref$USD)
diff.GBP &lt;- diff(eurofxref$GBP)
plot(eurofxref$Date[1:(n-1)], diff.USD, pch=20,
  main=&quot;Daily difference in exchange rate for USD (black) and GBP (red)
    against the Euro&quot;, xlab=&quot;Date&quot;, ylab=&quot;Difference in price of 1 Euro&quot;)
points(eurofxref$Date[1:(n-1)], diff.GBP, pch=20, col=&quot;red&quot;)</code></pre>
<p><img src="/sc1/reproducibility/literate_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The differences may be independent normal random variables. We can plot kernel density estimates for rescaled differences and an appropriate normal density to check this.</p>
<pre class="r"><code>rescaled.diff.USD &lt;- diff.USD/sd(diff.USD)
rescaled.diff.GBP &lt;- diff.GBP/sd(diff.GBP)

vs &lt;- seq(-10,10,0.01)
plot(density(rescaled.diff.USD), main=&quot;Kernel density estimates for USD (black)
  and GBP (red), with standard normal density (blue)&quot;)
lines(density(rescaled.diff.GBP), col=&quot;red&quot;)
lines(vs, dnorm(vs), col=&quot;blue&quot;)</code></pre>
<p><img src="/sc1/reproducibility/literate_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The estimated densities for the rescaled differences appear to be similar to each other, but different from a standard normal.</p>
<p>We can perform a Shapiro–Wilk test for each of the rescaled differences to see if they could be normal.</p>
<pre class="r"><code># shapiro.test sample size must be between 3 and 5000
shapiro.test(rescaled.diff.USD[1:5000])</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rescaled.diff.USD[1:5000]
## W = 0.97014, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code>shapiro.test(rescaled.diff.GBP[1:5000])</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rescaled.diff.GBP[1:5000]
## W = 0.93928, p-value &lt; 2.2e-16</code></pre>
<p>There is very strong evidence against the rescaled differences being normally distributed.</p>
<p>We can also perform a Kolmogorov–Smirnov test to see if the rescaled differences could be from the same distribution.</p>
<pre class="r"><code>ks.test(rescaled.diff.USD, rescaled.diff.GBP)</code></pre>
<pre><code>## Warning in ks.test(rescaled.diff.USD, rescaled.diff.GBP): p-value will be
## approximate in the presence of ties</code></pre>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  rescaled.diff.USD and rescaled.diff.GBP
## D = 0.024573, p-value = 0.0861
## alternative hypothesis: two-sided</code></pre>
<p>The p-value is not that small, so evidence against the two rescaled differences coming from the same distribution is weak.</p>
</div>
<div id="when-not-to-use-rmarkdown" class="section level2">
<h2>When not to use RMarkdown</h2>
<p>As suggested above, literate programming is very good for presenting a high-level data analysis. It is often used to communicate how data is processed and how conclusions are drawn.</p>
<p>It is not common to write packages of low-level functionality entirely using RMarkdown. Instead, people typically write R scripts with helpful comments that are easy to understand, and use function and variable names that ease understanding of the code itself. It is possible to use special “roxygen” comments that can automatically be turned into help documentation for users of those functions: we will cover this in more detail later.</p>
<p>An RMarkdown file has Markdown text and specially delimited code chunks, which can be processed to produce the desired output. <a href="https://yihui.name/knitr/demo/stitch/">An alternative</a> is to write an R script with specially delimited Markdown chunks. These chunks are automatically ignored by R as they are parsed as comments, but can optionally be converted into a literate programming document by the <code>knitr::spin</code> function.</p>
</div>


  <footer>
  

<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>


<script type="text/javascript">
var sc_project=12110974;
var sc_invisible=1;
var sc_security="9b171880";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12110974/0/9b171880/1/"
alt="Web Analytics"></a></div></noscript>








  


<p align=right>

<a href='https://github.com/awllee/sc1/blob/master/content/reproducibility/literate.Rmd'>View source</a>

|

<a href='https://github.com/awllee/sc1/edit/master/content/reproducibility/literate.Rmd'>Edit source</a>

</p>





<script src="https://utteranc.es/client.js"
        repo="awllee/sc1"
        issue-term="pathname"
        label="utterance"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>



  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© 2020 <a href="https://sites.google.com/view/anthonylee">Anthony Lee</a>, <a href="http://www.bristol.ac.uk/maths/people/feng-yu/index.html">Feng Yu</a>, <a href="https://people.maths.bris.ac.uk/~tk18582/">Tobias Kley</a>, <a href="https://mfasiolo.github.io/">Matteo Fasiolo</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

